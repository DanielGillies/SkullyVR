<!DOCTYPE html>
<html>

<head>
    <title></title>
    <style>
    #myProgress {
        width: 100%;
        height: 30px;
        position: relative;
        background-color: grey;
    }
    
    #myBar {
        width: 10px;
        height: 30px;
        position: absolute;
        background-color: green;
    }
    </style>
    <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script> -->
</head>

<body>
    <div id="myProgress">
        <div id="myBar">FFF</div>
    </div>
    <script>
    document.addEventListener("click", function() {
        console.log("CLICKED")
        init();
        document.removeEventListener("click", arguments.callee, false);
    }, false)

    function init() {
        // Create video in background and start playing
        var video = document.createElement('video');
        video.src = 'http://vr.skully.com/flying.mp4';
        video.controls = true;
        video.muted = true;
        video.play();
        video.addEventListener("canplay", function() {
            console.log("CAN PLAY");
            video.pause();
        })

        video.addEventListener("progress", function() {
            video.play();
            video.pause();
            var loadedPercentage = this.buffered.end(0) / this.duration;
            // console.log(loadedPercentage);
            var elem = document.getElementById("myBar");
            elem.style.width = loadedPercentage * 100 + "%";
            elem.innerHTML = Math.round(loadedPercentage * 100) + "%";
            if (loadedPercentage == 1) {
                document.body.appendChild(video);
                video.play();
                video.removeEventListener("progress", arguments.callee, false)
            }
        }, false);
    }
    </script>
</body>

</html>
